<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AniWatch - Stream Anime for Free</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ff5e57;
            --secondary-color: #3d3d3d;
            --background-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-color: #ffffff;
            --text-secondary: #b3b3b3;
            --hover-color: #ff7f78;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            overflow-x: hidden;
        }

        /* Header Styles */
        header {
            background-color: rgba(26, 26, 26, 0.9);
            padding: 1rem 2rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }

        .logo span {
            color: var(--text-color);
        }

        .search-container {
            display: flex;
            align-items: center;
            position: relative;
            width: 40%;
        }

        .search-input {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: 30px;
            border: none;
            background-color: var(--secondary-color);
            color: var(--text-color);
            font-size: 1rem;
            padding-right: 3rem;
        }

        .search-btn {
            position: absolute;
            right: 10px;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-link {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-link:hover {
            color: var(--primary-color);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Main Content Styles */
        main {
            margin-top: 80px;
            padding: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title i {
            color: var(--primary-color);
        }

        .anime-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .anime-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
        }

        .anime-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .anime-poster {
            width: 100%;
            height: 280px;
            object-fit: cover;
        }

        .anime-info {
            padding: 1rem;
        }

        .anime-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .anime-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .episode-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--primary-color);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .rank-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #ffc048;
            color: #000;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Spotlight Section */
        .spotlight-container {
            margin-bottom: 3rem;
        }

        .spotlight-slider {
            display: flex;
            gap: 1.5rem;
            overflow-x: auto;
            padding-bottom: 1rem;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--secondary-color);
        }

        .spotlight-slider::-webkit-scrollbar {
            height: 8px;
        }

        .spotlight-slider::-webkit-scrollbar-track {
            background: var(--secondary-color);
            border-radius: 10px;
        }

        .spotlight-slider::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 10px;
        }

        .spotlight-card {
            min-width: 300px;
            height: 400px;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            flex-shrink: 0;
        }

        .spotlight-bg {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.7);
        }

        .spotlight-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
        }

        .spotlight-title {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .spotlight-jtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .spotlight-desc {
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .spotlight-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .spotlight-meta-item {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .watch-now-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.6rem 1.5rem;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .watch-now-btn:hover {
            background-color: var(--hover-color);
        }

        /* Top 10 Section */
        .top10-container {
            margin-bottom: 3rem;
        }

        .top10-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .top10-tab {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-weight: 600;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .top10-tab.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
        }

        .top10-tab:hover {
            color: var(--text-color);
        }

        .top10-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        /* Anime Detail Page */
        .anime-detail-container {
            display: flex;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .anime-poster-large {
            width: 300px;
            height: 450px;
            object-fit: cover;
            border-radius: 8px;
            flex-shrink: 0;
        }

        .anime-detail-content {
            flex-grow: 1;
        }

        .anime-detail-title {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .anime-detail-jtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .anime-detail-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .anime-detail-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .anime-detail-meta-item i {
            color: var(--primary-color);
        }

        .anime-detail-description {
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .anime-detail-genres {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .genre-tag {
            background-color: var(--secondary-color);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.2rem;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .primary-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }

        .primary-btn:hover {
            background-color: var(--hover-color);
        }

        .secondary-btn {
            background-color: transparent;
            border: 1px solid var(--text-secondary);
            color: var(--text-color);
        }

        .secondary-btn:hover {
            border-color: var(--text-color);
        }

        /* Episodes Section */
        .episodes-container {
            margin-bottom: 3rem;
        }

        .episodes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        .episode-card {
            background-color: var(--card-bg);
            border-radius: 6px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .episode-card:hover {
            background-color: var(--secondary-color);
        }

        .episode-number {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .episode-title {
            font-size: 0.8rem;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Watch Page */
        .watch-container {
            margin-bottom: 3rem;
        }

        .video-container {
            width: 100%;
            aspect-ratio: 16/9;
            background-color: #000;
            margin-bottom: 1.5rem;
        }

        .video-player {
            width: 100%;
            height: 100%;
        }

        .episode-selector {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .episode-nav-btn {
            background-color: var(--secondary-color);
            border: none;
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: background-color 0.3s;
        }

        .episode-nav-btn:hover {
            background-color: var(--card-bg);
        }

        .episode-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .server-selector {
            margin-bottom: 1.5rem;
        }

        .server-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .server-tab {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-weight: 600;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .server-tab.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
        }

        .server-tab:hover {
            color: var(--text-color);
        }

        .server-options {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .server-option {
            background-color: var(--secondary-color);
            border: none;
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .server-option.active {
            background-color: var(--primary-color);
        }

        .server-option:hover {
            background-color: var(--card-bg);
        }

        .anime-info-watch {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .anime-poster-watch {
            width: 120px;
            height: 180px;
            object-fit: cover;
            border-radius: 6px;
        }

        .anime-detail-watch {
            flex-grow: 1;
        }

        .anime-title-watch {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .anime-episode-title {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        /* Search Results */
        .search-results-container {
            margin-bottom: 3rem;
        }

        .search-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .search-query {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .search-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filter-tag {
            background-color: var(--secondary-color);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-tag i {
            cursor: pointer;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }

        .page-btn {
            background-color: var(--secondary-color);
            border: none;
            color: var(--text-color);
            width: 40px;
            height: 40px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .page-btn.active {
            background-color: var(--primary-color);
        }

        .page-btn:hover:not(.active) {
            background-color: var(--card-bg);
        }

        /* Footer */
        footer {
            background-color: var(--secondary-color);
            padding: 3rem 2rem;
            text-align: center;
        }

        .footer-logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
            display: inline-block;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--text-color);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-link:hover {
            color: var(--primary-color);
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .social-link {
            color: var(--text-color);
            font-size: 1.5rem;
            transition: color 0.3s;
        }

        .social-link:hover {
            color: var(--primary-color);
        }

        .copyright {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            width: 100%;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            header {
                padding: 1rem;
            }

            .logo {
                font-size: 1.5rem;
            }

            .search-container {
                width: 60%;
            }

            .nav-links {
                display: none;
            }

            .mobile-menu-btn {
                display: block;
            }

            main {
                padding: 1rem;
            }

            .anime-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .anime-poster {
                height: 220px;
            }

            .spotlight-card {
                min-width: 250px;
                height: 350px;
            }

            .spotlight-title {
                font-size: 1.5rem;
            }

            .anime-detail-container {
                flex-direction: column;
            }

            .anime-poster-large {
                width: 100%;
                height: auto;
                max-height: 500px;
            }

            .anime-detail-title {
                font-size: 1.5rem;
            }

            .anime-detail-jtitle {
                font-size: 1rem;
            }

            .anime-info-watch {
                flex-direction: column;
            }

            .anime-poster-watch {
                width: 100%;
                height: auto;
                max-height: 300px;
            }
        }

        @media (max-width: 480px) {
            .search-container {
                width: 70%;
            }

            .anime-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 1rem;
            }

            .anime-poster {
                height: 180px;
            }

            .spotlight-card {
                min-width: 200px;
                height: 300px;
            }

            .spotlight-title {
                font-size: 1.2rem;
            }

            .spotlight-content {
                padding: 1rem;
            }

            .episodes-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <a href="index.html" class="logo">Ani<span>Watch</span></a>
        
        <div class="search-container">
            <input type="text" class="search-input" placeholder="Search anime...">
            <button class="search-btn"><i class="fas fa-search"></i></button>
        </div>
        
        <nav class="nav-links">
            <a href="index.html" class="nav-link">Home</a>
            <a href="#" class="nav-link">Popular</a>
            <a href="#" class="nav-link">Airing</a>
            <a href="#" class="nav-link">Genres</a>
        </nav>
        
        <button class="mobile-menu-btn">
            <i class="fas fa-bars"></i>
        </button>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Home Page (default view) -->
        <div id="home-page">
            <!-- Spotlight Section -->
            <div class="spotlight-container">
                <h2 class="section-title"><i class="fas fa-star"></i> Spotlight</h2>
                <div class="spotlight-slider" id="spotlight-slider">
                    <!-- Spotlight items will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Latest Episodes Section -->
            <div class="section-container">
                <h2 class="section-title"><i class="fas fa-clock"></i> Recently Updated</h2>
                <div class="anime-grid" id="latest-episodes">
                    <!-- Latest episodes will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Top 10 Section -->
            <div class="top10-container">
                <h2 class="section-title"><i class="fas fa-crown"></i> Top 10 Anime</h2>
                <div class="top10-tabs">
                    <button class="top10-tab active" data-tab="today">Today</button>
                    <button class="top10-tab" data-tab="week">This Week</button>
                    <button class="top10-tab" data-tab="month">This Month</button>
                </div>
                <div class="top10-grid" id="top10-today">
                    <!-- Top 10 today will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
                <div class="top10-grid hidden" id="top10-week">
                    <!-- Top 10 week will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
                <div class="top10-grid hidden" id="top10-month">
                    <!-- Top 10 month will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Trending Section -->
            <div class="section-container">
                <h2 class="section-title"><i class="fas fa-fire"></i> Trending Now</h2>
                <div class="anime-grid" id="trending-animes">
                    <!-- Trending animes will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Popular Section -->
            <div class="section-container">
                <h2 class="section-title"><i class="fas fa-chart-line"></i> Most Popular</h2>
                <div class="anime-grid" id="popular-animes">
                    <!-- Popular animes will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Anime Detail Page (hidden by default) -->
        <div id="anime-detail-page" class="hidden">
            <div class="anime-detail-container">
                <img src="" alt="Anime Poster" class="anime-poster-large" id="anime-detail-poster">
                <div class="anime-detail-content">
                    <h1 class="anime-detail-title" id="anime-detail-title"></h1>
                    <h2 class="anime-detail-jtitle" id="anime-detail-jtitle"></h2>
                    
                    <div class="anime-detail-meta">
                        <div class="anime-detail-meta-item">
                            <i class="fas fa-star"></i>
                            <span id="anime-detail-rating"></span>
                        </div>
                        <div class="anime-detail-meta-item">
                            <i class="fas fa-film"></i>
                            <span id="anime-detail-type"></span>
                        </div>
                        <div class="anime-detail-meta-item">
                            <i class="fas fa-clock"></i>
                            <span id="anime-detail-duration"></span>
                        </div>
                        <div class="anime-detail-meta-item">
                            <i class="fas fa-play-circle"></i>
                            <span id="anime-detail-episodes"></span>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn primary-btn" id="watch-first-episode">
                            <i class="fas fa-play"></i> Watch Now
                        </button>
                        <button class="action-btn secondary-btn">
                            <i class="fas fa-plus"></i> Add to List
                        </button>
                    </div>
                    
                    <p class="anime-detail-description" id="anime-detail-description"></p>
                    
                    <div class="anime-detail-genres" id="anime-detail-genres">
                        <!-- Genres will be added here by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Episodes Section -->
            <div class="episodes-container">
                <h2 class="section-title"><i class="fas fa-list-ol"></i> Episodes</h2>
                <div class="episodes-grid" id="anime-episodes-list">
                    <!-- Episodes will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Recommended Section -->
            <div class="section-container">
                <h2 class="section-title"><i class="fas fa-thumbs-up"></i> Recommended</h2>
                <div class="anime-grid" id="recommended-animes">
                    <!-- Recommended animes will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Watch Page (hidden by default) -->
        <div id="watch-page" class="hidden">
            <div class="watch-container">
                <div class="video-container">
                    <video controls class="video-player" id="video-player">
                        Your browser does not support the video tag.
                    </video>
                </div>
                
                <div class="episode-selector">
                    <button class="episode-nav-btn" id="prev-episode-btn">
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <span id="current-episode-title">Episode 1: Title</span>
                    <button class="episode-nav-btn" id="next-episode-btn">
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="server-selector">
                    <div class="server-tabs">
                        <button class="server-tab active" data-category="sub">Sub</button>
                        <button class="server-tab" data-category="dub">Dub</button>
                        <button class="server-tab" data-category="raw">Raw</button>
                    </div>
                    <div class="server-options" id="server-options">
                        <!-- Server options will be added here by JavaScript -->
                    </div>
                </div>
                
                <div class="anime-info-watch">
                    <img src="" alt="Anime Poster" class="anime-poster-watch" id="watch-anime-poster">
                    <div class="anime-detail-watch">
                        <h2 class="anime-title-watch" id="watch-anime-title"></h2>
                        <h3 class="anime-episode-title" id="watch-episode-title"></h3>
                        <button class="action-btn secondary-btn" id="back-to-detail">
                            <i class="fas fa-info-circle"></i> Anime Details
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Results Page (hidden by default) -->
        <div id="search-results-page" class="hidden">
            <div class="search-results-container">
                <div class="search-header">
                    <h2 class="search-query" id="search-query-text">Search Results for: <span></span></h2>
                </div>
                
                <div class="search-filters" id="search-filters">
                    <!-- Active filters will be shown here -->
                </div>
                
                <div class="anime-grid" id="search-results">
                    <!-- Search results will be added here by JavaScript -->
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
                
                <div class="pagination" id="search-pagination">
                    <!-- Pagination will be added here by JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-logo">Ani<span>Watch</span></div>
        
        <div class="footer-links">
            <a href="#" class="footer-link">Home</a>
            <a href="#" class="footer-link">About</a>
            <a href="#" class="footer-link">Privacy Policy</a>
            <a href="#" class="footer-link">DMCA</a>
            <a href="#" class="footer-link">Contact</a>
        </div>
        
        <div class="social-links">
            <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
            <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
            <a href="#" class="social-link"><i class="fab fa-discord"></i></a>
            <a href="#" class="social-link"><i class="fab fa-reddit"></i></a>
        </div>
        
        <p class="copyright">© 2023 AniWatch. All rights reserved.</p>
    </footer>

    <script>
        // API Configuration
        const API_BASE_URL = "https://aniwatch-api-net.vercel.app";
        
        // State management
        let currentPage = 'home';
        let currentAnimeId = null;
        let currentEpisodeId = null;
        let currentEpisodeNumber = 1;
        let currentCategory = 'sub';
        let currentServer = 'hd-1';
        let searchQuery = '';
        let searchPage = 1;
        let searchFilters = {};
        
        // Proxy function to handle CORS
        async function fetchWithProxy(url, options = {}) {
            const proxyUrl = '/api/proxy?url=' + encodeURIComponent(url);
            
            try {
                const response = await fetch(proxyUrl, options);
                if (!response.ok) throw new Error('Network response was not ok');
                return await response.json();
            } catch (error) {
                console.error('Error with proxy request:', error);
                throw error;
            }
        }

        // Modified API functions to use proxy
        async function fetchHomeData() {
            try {
                const apiUrl = `${API_BASE_URL}/api/v2/hianime/home`;
                return await fetchWithProxy(apiUrl);
            } catch (error) {
                console.error('Error fetching home data:', error);
                return null;
            }
        }
        
        async function fetchAnimeDetails(animeId) {
            try {
                const apiUrl = `${API_BASE_URL}/api/v2/hianime/anime/${animeId}`;
                return await fetchWithProxy(apiUrl);
            } catch (error) {
                console.error('Error fetching anime details:', error);
                return null;
            }
        }
        
        async function fetchAnimeEpisodes(animeId) {
            try {
                const apiUrl = `${API_BASE_URL}/api/v2/hianime/anime/${animeId}/episodes`;
                return await fetchWithProxy(apiUrl);
            } catch (error) {
                console.error('Error fetching anime episodes:', error);
                return null;
            }
        }
        
        async function fetchEpisodeServers(episodeId) {
            try {
                const apiUrl = `${API_BASE_URL}/api/v2/hianime/episode/servers?animeEpisodeId=${episodeId}`;
                return await fetchWithProxy(apiUrl);
            } catch (error) {
                console.error('Error fetching episode servers:', error);
                return null;
            }
        }
        
        async function fetchEpisodeSources(episodeId, server, category) {
            try {
                const apiUrl = `${API_BASE_URL}/api/v2/hianime/episode/sources?animeEpisodeId=${episodeId}?server=${server}&category=${category}`;
                return await fetchWithProxy(apiUrl);
            } catch (error) {
                console.error('Error fetching episode sources:', error);
                return null;
            }
        }
        
        async function fetchSearchResults(query, page = 1, filters = {}) {
            try {
                let apiUrl = `${API_BASE_URL}/api/v2/hianime/search?q=${encodeURIComponent(query)}&page=${page}`;
                
                // Add filters to the URL if they exist
                if (filters.genres) apiUrl += `&genres=${filters.genres}`;
                if (filters.type) apiUrl += `&type=${filters.type}`;
                if (filters.status) apiUrl += `&status=${filters.status}`;
                if (filters.rated) apiUrl += `&rated=${filters.rated}`;
                if (filters.score) apiUrl += `&score=${filters.score}`;
                if (filters.season) apiUrl += `&season=${filters.season}`;
                if (filters.language) apiUrl += `&language=${filters.language}`;
                if (filters.start_date) apiUrl += `&start_date=${filters.start_date}`;
                if (filters.end_date) apiUrl += `&end_date=${filters.end_date}`;
                if (filters.sort) apiUrl += `&sort=${filters.sort}`;
                
                return await fetchWithProxy(apiUrl);
            } catch (error) {
                console.error('Error fetching search results:', error);
                return null;
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            loadHomePage();
            setupEventListeners();
        });
        
        function setupEventListeners() {
            // Search functionality
            searchBtn.addEventListener('click', handleSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSearch();
            });
            
            // Top 10 tabs
            document.querySelectorAll('.top10-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelector('.top10-tab.active').classList.remove('active');
                    tab.classList.add('active');
                    
                    document.querySelector('.top10-grid:not(.hidden)').classList.add('hidden');
                    document.getElementById(`top10-${tab.dataset.tab}`).classList.remove('hidden');
                });
            });
            
            // Server tabs
            document.querySelectorAll('.server-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelector('.server-tab.active').classList.remove('active');
                    tab.classList.add('active');
                    currentCategory = tab.dataset.category;
                    loadEpisodeSources();
                });
            });
            
            // Navigation buttons
            document.getElementById('watch-first-episode').addEventListener('click', () => {
                navigateToWatchPage(currentAnimeId, 1);
            });
            
            document.getElementById('back-to-detail').addEventListener('click', () => {
                navigateToAnimeDetailPage(currentAnimeId);
            });
            
            document.getElementById('prev-episode-btn').addEventListener('click', () => {
                if (currentEpisodeNumber > 1) {
                    navigateToWatchPage(currentAnimeId, currentEpisodeNumber - 1);
                }
            });
            
            document.getElementById('next-episode-btn').addEventListener('click', () => {
                // In a real app, we would check if there's a next episode
                navigateToWatchPage(currentAnimeId, currentEpisodeNumber + 1);
            });
        }
        
        function handleSearch() {
            const query = searchInput.value.trim();
            if (query) {
                searchQuery = query;
                searchPage = 1;
                searchFilters = {};
                navigateToSearchResultsPage(query);
            }
        }
        
        function navigateToPage(page) {
            homePage.classList.add('hidden');
            animeDetailPage.classList.add('hidden');
            watchPage.classList.add('hidden');
            searchResultsPage.classList.add('hidden');
            
            currentPage = page;
            
            switch (page) {
                case 'home':
                    homePage.classList.remove('hidden');
                    loadHomePage();
                    break;
                case 'anime-detail':
                    animeDetailPage.classList.remove('hidden');
                    break;
                case 'watch':
                    watchPage.classList.remove('hidden');
                    break;
                case 'search-results':
                    searchResultsPage.classList.remove('hidden');
                    break;
            }
            
            window.scrollTo(0, 0);
        }
        
        function navigateToAnimeDetailPage(animeId) {
            currentAnimeId = animeId;
            navigateToPage('anime-detail');
            loadAnimeDetails(animeId);
        }
        
        function navigateToWatchPage(animeId, episodeNumber) {
            currentAnimeId = animeId;
            currentEpisodeNumber = episodeNumber;
            navigateToPage('watch');
            loadEpisodeSources();
        }
        
        function navigateToSearchResultsPage(query) {
            searchQuery = query;
            navigateToPage('search-results');
            loadSearchResults(query, searchPage, searchFilters);
        }
        
        async function loadHomePage() {
            const homeData = await fetchHomeData();
            if (!homeData || !homeData.success) return;
            
            const data = homeData.data;
            
            // Load Spotlight
            const spotlightSlider = document.getElementById('spotlight-slider');
            spotlightSlider.innerHTML = '';
            
            data.spotlightAnimes.slice(0, 5).forEach(anime => {
                const spotlightCard = document.createElement('div');
                spotlightCard.className = 'spotlight-card';
                spotlightCard.innerHTML = `
                    <img src="${anime.poster}" alt="${anime.name}" class="spotlight-bg">
                    <div class="spotlight-content">
                        <h3 class="spotlight-title">${anime.name}</h3>
                        <h4 class="spotlight-jtitle">${anime.jname}</h4>
                        <p class="spotlight-desc">${anime.description}</p>
                        <div class="spotlight-meta">
                            ${anime.otherInfo.map(info => `<span class="spotlight-meta-item">${info}</span>`).join('')}
                        </div>
                        <button class="watch-now-btn" data-anime-id="${anime.id}">Watch Now</button>
                    </div>
                `;
                spotlightSlider.appendChild(spotlightCard);
                
                // Add event listener to the watch now button
                spotlightCard.querySelector('.watch-now-btn').addEventListener('click', () => {
                    navigateToAnimeDetailPage(anime.id);
                });
            });
            
            // Load Latest Episodes
            const latestEpisodesGrid = document.getElementById('latest-episodes');
            latestEpisodesGrid.innerHTML = '';
            
            data.latestEpisodeAnimes.slice(0, 12).forEach(anime => {
                const animeCard = createAnimeCard(anime);
                latestEpisodesGrid.appendChild(animeCard);
            });
            
            // Load Top 10 Today
            const top10TodayGrid = document.getElementById('top10-today');
            top10TodayGrid.innerHTML = '';
            
            data.top10Animes.today.forEach((anime, index) => {
                const animeCard = createAnimeCard(anime, index + 1);
                top10TodayGrid.appendChild(animeCard);
            });
            
            // Load Top 10 Week
            const top10WeekGrid = document.getElementById('top10-week');
            top10WeekGrid.innerHTML = '';
            
            data.top10Animes.week.forEach((anime, index) => {
                const animeCard = createAnimeCard(anime, index + 1);
                top10WeekGrid.appendChild(animeCard);
            });
            
            // Load Top 10 Month
            const top10MonthGrid = document.getElementById('top10-month');
            top10MonthGrid.innerHTML = '';
            
            data.top10Animes.month.forEach((anime, index) => {
                const animeCard = createAnimeCard(anime, index + 1);
                top10MonthGrid.appendChild(animeCard);
            });
            
            // Load Trending Animes
            const trendingGrid = document.getElementById('trending-animes');
            trendingGrid.innerHTML = '';
            
            data.trendingAnimes.slice(0, 12).forEach(anime => {
                const animeCard = createAnimeCard(anime);
                trendingGrid.appendChild(animeCard);
            });
            
            // Load Popular Animes
            const popularGrid = document.getElementById('popular-animes');
            popularGrid.innerHTML = '';
            
            data.mostPopularAnimes.slice(0, 12).forEach(anime => {
                const animeCard = createAnimeCard(anime);
                popularGrid.appendChild(animeCard);
            });
        }
        
        function createAnimeCard(anime, rank = null) {
            const animeCard = document.createElement('div');
            animeCard.className = 'anime-card';
            
            let episodeText = '';
            if (anime.episodes) {
                if (anime.episodes.sub && anime.episodes.dub) {
                    episodeText = `EP ${anime.episodes.sub} (Sub) / ${anime.episodes.dub} (Dub)`;
                } else if (anime.episodes.sub) {
                    episodeText = `EP ${anime.episodes.sub} (Sub)`;
                } else if (anime.episodes.dub) {
                    episodeText = `EP ${anime.episodes.dub} (Dub)`;
                }
            }
            
            animeCard.innerHTML = `
                <img src="${anime.poster}" alt="${anime.name}" class="anime-poster">
                ${rank ? `<div class="rank-badge">${rank}</div>` : ''}
                ${episodeText ? `<div class="episode-badge">${episodeText.split(' / ')[0]}</div>` : ''}
                <div class="anime-info">
                    <h3 class="anime-title">${anime.name}</h3>
                    <div class="anime-meta">
                        <span>${anime.type || 'TV'}</span>
                        ${anime.rating ? `<span>${anime.rating}</span>` : ''}
                    </div>
                </div>
            `;
            
            animeCard.addEventListener('click', () => {
                navigateToAnimeDetailPage(anime.id);
            });
            
            return animeCard;
        }
        
        async function loadAnimeDetails(animeId) {
            const animeDetails = await fetchAnimeDetails(animeId);
            if (!animeDetails || !animeDetails.success) return;
            
            const data = animeDetails.data.anime.info;
            
            // Set anime details
            document.getElementById('anime-detail-poster').src = data.poster;
            document.getElementById('anime-detail-title').textContent = data.name;
            document.getElementById('anime-detail-jtitle').textContent = data.jname || '';
            document.getElementById('anime-detail-rating').textContent = data.stats.rating || 'N/A';
            document.getElementById('anime-detail-type').textContent = data.stats.type || 'TV';
            document.getElementById('anime-detail-duration').textContent = data.stats.duration || 'N/A';
            
            let episodeText = '';
            if (data.stats.episodes) {
                if (data.stats.episodes.sub && data.stats.episodes.dub) {
                    episodeText = `${data.stats.episodes.sub} (Sub) / ${data.stats.episodes.dub} (Dub)`;
                } else if (data.stats.episodes.sub) {
                    episodeText = `${data.stats.episodes.sub} (Sub)`;
                } else if (data.stats.episodes.dub) {
                    episodeText = `${data.stats.episodes.dub} (Dub)`;
                }
            }
            document.getElementById('anime-detail-episodes').textContent = episodeText || 'N/A';
            
            document.getElementById('anime-detail-description').textContent = data.description || 'No description available.';
            
            // Set genres
            const genresContainer = document.getElementById('anime-detail-genres');
            genresContainer.innerHTML = '';
            
            if (animeDetails.data.anime.moreInfo.genres) {
                animeDetails.data.anime.moreInfo.genres.forEach(genre => {
                    const genreTag = document.createElement('span');
                    genreTag.className = 'genre-tag';
                    genreTag.textContent = genre;
                    genresContainer.appendChild(genreTag);
                });
            }
            
            // Load episodes
            const episodesData = await fetchAnimeEpisodes(animeId);
            if (episodesData && episodesData.success) {
                const episodesContainer = document.getElementById('anime-episodes-list');
                episodesContainer.innerHTML = '';
                
                episodesData.data.episodes.forEach(episode => {
                    const episodeCard = document.createElement('div');
                    episodeCard.className = 'episode-card';
                    episodeCard.innerHTML = `
                        <div class="episode-number">Episode ${episode.number}</div>
                        <div class="episode-title">${episode.title || ''}</div>
                    `;
                    
                    episodeCard.addEventListener('click', () => {
                        navigateToWatchPage(animeId, episode.number);
                    });
                    
                    episodesContainer.appendChild(episodeCard);
                });
            }
            
            // Load recommended animes
            const recommendedContainer = document.getElementById('recommended-animes');
            recommendedContainer.innerHTML = '';
            
            if (animeDetails.data.recommendedAnimes) {
                animeDetails.data.recommendedAnimes.slice(0, 12).forEach(anime => {
                    const animeCard = createAnimeCard(anime);
                    recommendedContainer.appendChild(animeCard);
                });
            }
        }
        
        async function loadEpisodeSources() {
            // First, get the episode ID from the anime's episodes list
            const episodesData = await fetchAnimeEpisodes(currentAnimeId);
            if (!episodesData || !episodesData.success) return;
            
            const episode = episodesData.data.episodes.find(ep => ep.number === currentEpisodeNumber);
            if (!episode) return;
            
            currentEpisodeId = episode.episodeId;
            
            // Update UI
            document.getElementById('current-episode-title').textContent = `Episode ${episode.number}: ${episode.title || ''}`;
            document.getElementById('watch-episode-title').textContent = `Episode ${episode.number}: ${episode.title || ''}`;
            
            // Get anime details for the poster and title
            const animeDetails = await fetchAnimeDetails(currentAnimeId);
            if (animeDetails && animeDetails.success) {
                document.getElementById('watch-anime-poster').src = animeDetails.data.anime.info.poster;
                document.getElementById('watch-anime-title').textContent = animeDetails.data.anime.info.name;
            }
            
            // Get available servers
            const serversData = await fetchEpisodeServers(currentEpisodeId);
            if (!serversData || !serversData.success) return;
            
            // Update server options
            const serverOptionsContainer = document.getElementById('server-options');
            serverOptionsContainer.innerHTML = '';
            
            let servers = [];
            if (currentCategory === 'sub' && serversData.data.sub) {
                servers = serversData.data.sub;
            } else if (currentCategory === 'dub' && serversData.data.dub) {
                servers = serversData.data.dub;
            } else if (currentCategory === 'raw' && serversData.data.raw) {
                servers = serversData.data.raw;
            }
            
            servers.forEach(server => {
                const serverOption = document.createElement('button');
                serverOption.className = 'server-option';
                if (server.serverName === currentServer) {
                    serverOption.classList.add('active');
                }
                serverOption.textContent = server.serverName;
                serverOption.dataset.serverId = server.serverId;
                
                serverOption.addEventListener('click', () => {
                    currentServer = server.serverName;
                    document.querySelector('.server-option.active').classList.remove('active');
                    serverOption.classList.add('active');
                    loadVideoSource();
                });
                
                serverOptionsContainer.appendChild(serverOption);
            });
            
            // Load the video source
            loadVideoSource();
        }
        
        async function loadVideoSource() {
            const videoPlayer = document.getElementById('video-player');
            videoPlayer.innerHTML = ''; // Clear previous sources
            
            const sourcesData = await fetchEpisodeSources(currentEpisodeId, currentServer, currentCategory);
            if (!sourcesData || !sourcesData.success) return;
            
            // Add sources to the video player
            sourcesData.data.sources.forEach(source => {
                const sourceElement = document.createElement('source');
                sourceElement.src = source.url;
                if (source.quality) {
                    sourceElement.title = source.quality;
                }
                videoPlayer.appendChild(sourceElement);
            });
            
            // Add subtitles if available
            if (sourcesData.data.subtitles) {
                sourcesData.data.subtitles.forEach(subtitle => {
                    const trackElement = document.createElement('track');
                    trackElement.kind = 'subtitles';
                    trackElement.label = subtitle.lang;
                    trackElement.srclang = subtitle.lang.toLowerCase();
                    trackElement.src = subtitle.url;
                    videoPlayer.appendChild(trackElement);
                });
            }
            
            // Load the video
            videoPlayer.load();
        }
        
        async function loadSearchResults(query, page = 1, filters = {}) {
            document.getElementById('search-query-text').querySelector('span').textContent = query;
            
            // Update search filters display
            const filtersContainer = document.getElementById('search-filters');
            filtersContainer.innerHTML = '';
            
            for (const [key, value] of Object.entries(filters)) {
                if (value) {
                    const filterTag = document.createElement('div');
                    filterTag.className = 'filter-tag';
                    filterTag.innerHTML = `
                        ${key}: ${value} <i class="fas fa-times"></i>
                    `;
                    
                    filterTag.querySelector('i').addEventListener('click', () => {
                        // Remove this filter
                        const newFilters = {...filters};
                        delete newFilters[key];
                        searchFilters = newFilters;
                        loadSearchResults(query, 1, newFilters);
                    });
                    
                    filtersContainer.appendChild(filterTag);
                }
            }
            
            const searchData = await fetchSearchResults(query, page, filters);
            if (!searchData || !searchData.success) return;
            
            // Display results
            const resultsContainer = document.getElementById('search-results');
            resultsContainer.innerHTML = '';
            
            if (searchData.data.animes.length === 0) {
                resultsContainer.innerHTML = '<p>No results found. Try a different search term.</p>';
                return;
            }
            
            searchData.data.animes.forEach(anime => {
                const animeCard = createAnimeCard(anime);
                resultsContainer.appendChild(animeCard);
            });
            
            // Set up pagination
            const paginationContainer = document.getElementById('search-pagination');
            paginationContainer.innerHTML = '';
            
            const totalPages = searchData.data.totalPages;
            const currentPage = searchData.data.currentPage;
            
            if (totalPages > 1) {
                // Previous button
                if (currentPage > 1) {
                    const prevBtn = document.createElement('button');
                    prevBtn.className = 'page-btn';
                    prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                    prevBtn.addEventListener('click', () => {
                        loadSearchResults(query, currentPage - 1, filters);
                    });
                    paginationContainer.appendChild(prevBtn);
                }
                
                // Page numbers
                const startPage = Math.max(1, currentPage - 2);
                const endPage = Math.min(totalPages, currentPage + 2);
                
                for (let i = startPage; i <= endPage; i++) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = `page-btn ${i === currentPage ? 'active' : ''}`;
                    pageBtn.textContent = i;
                    pageBtn.addEventListener('click', () => {
                        loadSearchResults(query, i, filters);
                    });
                    paginationContainer.appendChild(pageBtn);
                }
                
                // Next button
                if (currentPage < totalPages) {
                    const nextBtn = document.createElement('button');
                    nextBtn.className = 'page-btn';
                    nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                    nextBtn.addEventListener('click', () => {
                        loadSearchResults(query, currentPage + 1, filters);
                    });
                    paginationContainer.appendChild(nextBtn);
                }
            }
        }
    </script>
</body>
</html>
